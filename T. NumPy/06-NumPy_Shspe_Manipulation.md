# Shape Manipulation

## 🔹 2-5. Shape Manipulation — 핵심 개념

### 📌 배열의 구조(shape)를 다루는 주요 기능

| 기능         | 예시 또는 결과                  | 설명                                                             |
|--------------|----------------------------------|------------------------------------------------------------------|
| `.shape`     | `(3, 4)`                         | 배열의 구조를 튜플로 반환 → 행/열/차원 수 확인                   |
| `.reshape()` | `a.reshape(6, 2)`                | 배열의 형태 변경 → 요소 수는 동일해야 함                         |
| `.ravel()`   | `[8. 3. 4. 2. 7. 6. 1. 0. 6. 6. 9. 5.]` | 다차원 배열을 1D로 평탄화 → 뷰(view) 반환                         |
| `.T`         | `a.T → shape: (4, 3)`            | 배열 전치 → 행과 열을 뒤바꿈                                     |
| `.flat`      | `for x in a.flat:`               | 1D 반복자 반환 → 모든 요소를 순차적으로 접근 가능                |
| `...`        | `a[1, ...]`, `a[..., 2]`         | 생략된 모든 차원을 자동으로 채움 → 다차원 인덱싱에서 유용         |


## 🧪 예제 분석
### ✅ 다차원 인덱싱
```python
c = np.array([[[0, 1, 2], [10, 12, 13]],
              [[100, 101, 102], [110, 112, 113]]])
print(c.shape)        # (2, 2, 3)
print(c[1, ...])      # [[100 101 102], [110 112 113]]
print(c[..., 2])      # [[  2  13], [102 113]]
```

- ...는 생략된 모든 차원을 자동으로 채워줌
- c[1, ...] ≡ c[1, :, :]
- c[..., 2] ≡ c[:, :, 2]

### ✅ 반복 처리
```python
for row in c:
    print(row)        # 2D 배열 단위로 반복
```

### 출력 결과
```
[[ 0  1  2]
 [10 12 13]]
[[100 101 102]
 [110 112 113]]
```

```python
for elem in c.flat:
    print(elem)       # 모든 요소를 1D처럼 반복
```

### 출력 격과
'''
0
1
2
10
12
13
100
101
102
110
112
113
```        
- .flat은 1D 반복자로, 다차원 배열을 평탄하게 순회할 수 있음

✅ 배열 구조 변경
```python
a = np.floor(10 * np.random.random((3, 4)))
print(a.shape)        # (3, 4)
print(a.ravel())      # 1D 배열로 평탄화 [8. 3. 4. 2. 7. 6. 1. 0. 6. 6. 9. 5.]

print(a.reshape(6, 2))# (6, 2)로 재구성
'''
[[8. 3.]
 [4. 2.]
 [7. 6.]
 [1. 0.]
 [6. 6.]
 [9. 5.]]
'''

print(a.T)            # 전치 → (4, 3)
'''
[[8. 7. 6.]
 [3. 6. 6.]
 [4. 1. 9.]
 [2. 0. 5.]]
'''
```

- .ravel()은 뷰(view)를 반환 → 원본 수정 가능
- .reshape()은 새로운 shape으로 배열을 재구성
- .T는 전치 → 행과 열을 뒤바꿈

## 💬 한마디
Shape Manipulation은 단순한 배열 변경을 넘어서
데이터 전처리, 이미지 처리, 모델 입력 구조 설계에 핵심.
특히 reshape, ravel, transpose는 실무에서 매일 쓰이는 도구.

---

# 추가 기능
| 기능 또는 표현         | 예시 코드                        | 설명                                                             |
|------------------------|----------------------------------|------------------------------------------------------------------|
| `np.newaxis`           | `a[:, np.newaxis]`               | 차원 추가 → (n,) → (n, 1) 형태로 변환                            |
| `np.expand_dims()`     | `np.expand_dims(a, axis=1)`      | 명시적으로 차원 추가 → 원하는 위치에 새 축 삽입                   |
| `np.squeeze()`         | `a.squeeze()`                    | 크기가 1인 차원 제거 → (1, n, 1) → (n,)                           |
| `np.swapaxes()`        | `np.swapaxes(a, 0, 1)`           | 두 축을 교환 → (3, 4) → (4, 3) 등                                |
| `np.reshape(-1)`       | `a.reshape(-1, 2)`               | 자동 크기 계산 → 전체 요소 수에 맞게 한 차원은 자동 설정          |
| `.resize()`            | `a.resize((2, 6))`               | 배열 크기 변경 (원본 수정) → 요소 수 부족 시 0 또는 반복으로 채움 |


## 🔍 예시 시각화
```python
a = np.array([1, 2, 3, 4])

print(a[:, np.newaxis])         # → [[1], [2], [3], [4]]
print(np.expand_dims(a, axis=0))# → [[1 2 3 4]]
print(np.squeeze(np.array([[1], [2], [3]])))  # → [1 2 3]
print(np.swapaxes(np.array([[1, 2], [3, 4]]), 0, 1))  # → [[1 3], [2 4]]
print(a.reshape(-1, 2))         # → [[1 2], [3 4]]
```

## 🧠 보강 포인트 — 항목별 설명 & 예제
### 1️⃣ np.newaxis — 차원 추가
- 설명: 배열에 새로운 차원을 추가할 때 사용
- 용도: 1D → 2D 변환, 브로드캐스팅 준비
```python
a = np.array([1, 2, 3])
print(a.shape)              # (3,)
print(a[:, np.newaxis])     # shape: (3, 1)
```

출력
```
[[1]
 [2]
 [3]]
```


### 2️⃣ np.expand_dims() — 명시적 차원 추가
- 설명: 지정한 위치(axis)에 새 차원을 추가
- 차이점: np.newaxis보다 유연함
```python
a = np.array([1, 2, 3])
b = np.expand_dims(a, axis=0)  # shape: (1, 3)
c = np.expand_dims(a, axis=1)  # shape: (3, 1)
```

### 출력
```
b → [[1 2 3]]
c → [[1]
     [2]
     [3]]

```

### 3️⃣ np.squeeze() — 크기 1인 차원 제거
- 설명: shape 중 크기가 1인 차원을 제거
- 용도: 모델 출력 후 차원 정리, 불필요한 축 제거
```python
a = np.array([[[1], [2], [3]]])
print(a.shape)         # (1, 3, 1)
print(np.squeeze(a))   # shape: (3,)
```

### 출력
```
[1 2 3]
```


### 4️⃣ np.swapaxes() — 축 교환
- 설명: 두 축의 위치를 바꿈
- 용도: 이미지 처리, 전치보다 유연한 축 변경
```python
a = np.array([[1, 2], [3, 4]])
print(np.swapaxes(a, 0, 1))
```

### 출력
```
[[1 3]
 [2 4]]
```


### 5️⃣ np.reshape(-1) — 자동 크기 계산
- 설명: -1은 자동으로 남은 차원을 계산
- 용도: 전체 요소 수에 맞게 유연하게 재구성
```python
a = np.array([[1, 2], [3, 4]])
print(a.reshape(-1))       # → [1 2 3 4]
print(a.reshape(-1, 2))    # → [[1 2], [3 4]]
```


### 6️⃣ .resize() — 배열 크기 변경 (원본 수정)
- 설명: 배열 자체를 변경하며 크기 조정
- 주의: 요소 수 부족 시 0 또는 반복으로 채움
```python
a = np.array([1, 2, 3])
a.resize((2, 3))
print(a)
```

## 출력
```
[[1 2 3]
 [0 0 0]]
```
