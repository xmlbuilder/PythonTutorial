# 고차 함수

## 고차 함수란 무엇인가
- 정의:
- **다른 함수를 인자로 받거나, 함수를 결과로 돌려주는 함수** 를 고차 함수라고 합니다.
- 예시
  - 함수를 인자로 받는 경우
```python
def apply_twice(f, x):
    return f(f(x))
```
```python
def plus_one(n):
    return n + 1
```
```python
print(apply_twice(plus_one, 3))  # 5
```
- 예시
  - 함수를 반환하는 경우
```python
def make_power(exp):
    def power(x):
        return x ** exp
    return power
```
```python
square = make_power(2)   # x^2
cube   = make_power(3)   # x^3
```
```python
print(square(4))  # 16
print(cube(2))    # 8
```
- 이 패턴을 이해하면, **함수도 데이터처럼 다룬다** 라는 감각이 생기고, 재사용성과 표현력이 크게 올라갑니다.

## 핵심 고차 함수 
### 1: map
- 역할:
  - map(func, iterable)은 iterable의 각 원소에 func를 적용해서, **변환된** 값들의 iterator를 돌려줍니다.
- 형태
  - map(함수, 반복가능객체)
- 예시
  - 제곱하기
```python
numbers = [1, 2, 3, 4]
squared_iter = map(lambda x: x ** 2, numbers)
squared = list(squared_iter)
print(squared)  # [1, 4, 9, 16]
```
- 언제 쓰면 좋은지
  - **리스트/튜플 등 전체를 다른 값으로 변환하고 싶을 때**
  - for 루프로 새 리스트 만들기를 간단히 쓰고 싶을 때
  - 파이썬스러운 대체 표현
```pythn
squared = [x ** 2 for x in numbers]  # 리스트 내포
```
- 실무에서는 map보다는 리스트/제너레이터 컴프리헨션이 더 자주 쓰이지만, 함수형 패턴 이해에는 map이 중요합니다.

## 핵심 고차 함수 
### 2: filter
- 역할:
  - filter(func, iterable)은 각 원소에 대해 func를 적용해서 True인 것만 남깁니다.
- 형태
  - filter(조건함수, 반복가능객체)
  - 조건함수는 True/False를 반환해야 함
- 예시 – 짝수만 남기기
```python
numbers = [1, 2, 3, 4, 5, 6]
evens_iter = filter(lambda x: x % 2 == 0, numbers)
evens = list(evens_iter)
print(evens)  # [2, 4, 6]
```
- 파이썬스러운 대체 표현
```python
evens = [x for x in numbers if x % 2 == 0]
```
- filter 역시 컴프리헨션으로 대체 가능한 경우가 많지만, **조건으로 거르는 것이다** 라는 개념을 익히는 데 좋습니다.

## 핵심 고차 함수 
### 3: reduce
- 파이썬 3부터는 functools.reduce 안에 들어 있습니다.
- 역할:
  - reduce(func, iterable, 초기값?)은 iterable의 원소들을 누적해서 하나의 값으로 줄여 나갑니다.
  - 예를 들어 합, 곱, 최대값 계산 같은 것들입니다.
- 형태
```python
from functools import reduce
```
  - reduce(이항함수, 반복가능객체, 초기값_선택)
- 예시
  - 합 구하기
```python
from functools import reduce

numbers = [1, 2, 3, 4]

total = reduce(lambda acc, x: acc + x, numbers, 0)
print(total)  # 10
```

- 여기서 acc는 누적값(accumulator), x는 현재 원소입니다.
- 예시
  - 곱 구하기
```python
from functools import reduce

product = reduce(lambda acc, x: acc * x, [1, 2, 3, 4], 1)
print(product)  # 24
```
- 언제 쓰면 좋은지
  - **리스트 전체를 한 값으로 접어 넣는** 연산이 있을 때 (합, 곱, 최소, 최대, 카운트 등)
  - 하지만, 단순 합은 sum, 최대는 max 등 내장 함수를 쓰는 것이 더 읽기 좋습니다.

---

## lambda (익명 함수)와 고차 함수
- 고차 함수는 **함수** 를 인자로 받기 때문에, 매번 def로 이름 있는 함수를 만들면 코드가 지저분해집니다.
- 그래서 한 줄짜리 작은 함수를 간단히 표현하는 용도로 lambda를 많이 씁니다.
- 형태
  - lambda 인자들: 표현식
- 예:
```python
add = lambda x, y: x + y
print(add(2, 3))  # 5
```
- map/filter/reduce에서 lambda 자주 쓰기
```python
numbers = [1, 2, 3, 4, 5, 6]

squared = list(map(lambda x: x ** 2, numbers))
evens   = list(filter(lambda x: x % 2 == 0, numbers))

from functools import reduce
total   = reduce(lambda acc, x: acc + x, numbers, 0)
```
- 장점
  - 한 번만 쓸 간단한 함수를 간결하게 표현
  - 고차 함수와 같이 쓰면 코드가 컴팩트해짐
- 단점 / 주의점
  - 복잡한 lambda는 가독성이 매우 안 좋음
  - 디버깅이 어렵고, 이름이 없어서 의미 전달이 떨어질 수 있음
### 일반적인 팁:
- 한 줄로 직관적으로 읽히지 않으면 def로 이름 있는 함수로 바꾸는 게 좋습니다.
## functools.partial: 
- 일부 인자를 미리 고정하기functools.partial은 어떤 함수의 일부 인자를 미리 정해둔 새 함수를 만들어 줍니다.
- 이것도 **함수를 반환하는 함수** 라서 고차 함수의 한 형태입니다.
- 형태
```python
from functools import partial

new_func = partial(기존함수, 고정할_인자들...)
```
- 예시
  - 10을 항상 더하는 함수 만들기
```python
from functools import partial

def add(x, y):
    return x + y

add10 = partial(add, 10)  # x=10으로 고정
print(add10(5))  # 15  (10 + 5)
```
- map과 함께 사용하기
```python
from functools import partial

def power(base, exp):
    return base ** exp

square = partial(power, exp=2)
numbers = [1, 2, 3, 4]

squared = list(map(square, numbers))
print(squared)  # [1, 4, 9, 16]
```

- 이렇게 **자주 쓰는 인자 조합** 을 함수로 묶어서 재사용하면 코드가 훨씬 읽기 좋음.

## 데코레이터: 
- 실무에서 가장 많이 쓰는 고차 함수데코레이터는 **함수를 인자로 받아서, 새로운 함수를 반환하는 고차 함수** 입니다.
- 함수에 기능을 덧입히는 패턴.
- 기본 형태
```python
def my_decorator(func):
    def wrapper(*args, **kwargs):
        print("함수 호출 전")
        result = func(*args, **kwargs)
        print("함수 호출 후")
        return result
    return wrapper
```
- 데코레이터 적용
```python
@my_decorator
def hello(name):
    print(f"Hello, {name}!")

hello("JungHwan")
```

- 실제로는 로깅, 권한 체크, 시간 측정, 캐싱 등에 엄청 많이 쓰입니다.
- 다 고차 함수 패턴 위에서 돌아 감.

## 정리 + 공부 방향 추천
- 핵심 개념
  - 고차 함수 = 함수를 인자로 받거나, 함수를 반환하는 함수
  - map = 전체를 변환, filter = 조건으로 거르기, reduce = 하나의 값으로 접기
  - lambda = 한 줄짜리 익명 함수, 고차 함수와 궁합 좋음
  - partial, 데코레이터 역시 고차 함수 패턴의 응용

---

